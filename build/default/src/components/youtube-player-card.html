<html><head><link rel="import" href="../../bower_components/polymer/polymer.html"><link rel="import" href="../../bower_components/google-apis/google-youtube-api.html"><link rel="import" href="../../bower_components/paper-card/paper-card.html"><link rel="import" href="../../bower_components/iron-icon/iron-icon.html"><link rel="import" href="../../bower_components/iron-icons/iron-icons.html"><link rel="import" href="../../bower_components/iron-icons/av-icons.html"></head><body><dom-module id="youtube-player-card"><template><style>:host{display:block;}:host #card{width:var(--youtube-player-video-width, 240px);}:host .card-content{width:var(--youtube-player-video-width, 240px);height:var(--youtube-player-video-height, 135px);padding:0 !important;position:relative;display:flex;justify-content:center;align-items:center;overflow:hidden;}button.play-btn{background:var(--youtube-player-play-background-color, white);border:none;outline:none;width:75px;height:75px;display:flex;justify-content:center;align-items:center;z-index:99;border-radius:100%;cursor:pointer;opacity:0.3;transition:opacity .3s ease-in-out;}:host #contentVideo:hover .play-btn{opacity:0.9;}:host .play-button{color:var(--youtube-player-play-button-color, black);width:54px;height:54px;z-index:100;}:host .video{}#video{position:absolute;top:0;}.thumb-cont{width:var(--youtube-player-video-width, 240px);height:var(--youtube-player-video-height, 135px);background:var(--youtube-player-thumbnail-background, #757575);transition:opacity .5s ease-in-out;position:absolute;z-index:51;pointer-events:none;}.thumbnail{position:absolute;top:0;left:0;width:var(--youtube-player-video-width, 240px);height:var(--youtube-player-video-height, 135px);background-repeat:no-repeat;background-position:center center;background-size:100%;transition:opacity .3s ease-in-out;z-index:50;}:host .video-title{font-size:14px;letter-spacing:-.012em;line-height:32px;flex:1;margin-right:15px;color:var(--youtube-player-video-title-color, black);}.ellipsis{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;}.channel-title{font-size:13px;margin-right:15px;text-decoration:none;display:block;margin-top:-8px;color:var(--youtube-player-channel-color, #757575);}.title-wrap{padding-bottom:5px;padding-left:5px;}.actions-top{padding:1%;}.card-actions{padding:0 !important;}.actions{display:flex;color:#757575;padding:5px 16px;}.open-yt{border:none;outline:none;background:none;cursor:pointer;padding:6px;}.views{display:flex;flex-direction:row;align-items:center;border-top:1px solid #e8e8e8;padding:2%;font-size:12px;}.duration{flex:1;}iron-icon{margin-right:3px;}.duration,
            .views .view{display:flex;align-items:center;margin:0 3px 0 3px;}.views,
            .open-yt,
            .duration{color:#757575;}.yt-card-wrap{padding:10px;}</style><div class="yt-card-wrap"><google-youtube-api id="yapi"></google-youtube-api><paper-card id="card" elevation="1" animated-shadow="false"><div class="card-content" id="contentVideo"><button id="playBtn" on-click="playVideo" class="play-btn"><iron-icon class="play-button" icon="av:play-arrow"></iron-icon></button><div id="imageThumb" class="thumbnail"></div><div id="imageCont" class="thumb-cont"></div><div class="video" id="video"></div></div><div class="card-actions"><div class="actions-top"><div class="title-wrap"><div class="video-title ellipsis">[[videoTitle]]</div><a class="channel-title ellipsis" target="_blank" href="[[_openInYoutube(_youtubeChannel, channelId)]]">[[channelTitle]]</a></div></div><div class="views"><div class="view"><template is="dom-if" if="[[viewCount]]"><iron-icon icon="icons:visibility"></iron-icon>[[viewCount]]</template></div><template is="dom-if" if="[[duration]]"><div class="duration"><iron-icon icon="icons:query-builder"></iron-icon>[[convertDuration(duration)]]</div></template><a target="_blank" title="[[openExternal]]" class="open-yt" href="[[_openVideoYoutube(videoId, _youtubeVideo, _youtubePlaylist)]]"><iron-icon icon="icons:exit-to-app"></iron-icon></a></div></div></paper-card></div></template><script>Polymer({is:'youtube-player-card',properties:{YT:{type:Object,value:null},channelId:{type:String,value:'',notify:!0},videoTitle:{type:String,value:''},openExternal:{type:String,value:'Open in YouTube'},description:{type:String,value:''},thumbnail:{type:String,value:'',observer:'_updateThumb'},videoId:{type:String,value:'',notify:!0},player:{type:Object,value:null},viewCount:{type:Number,value:0},channelTitle:{type:String,value:''},videoKind:{type:String,value:''},_youtubePlaylist:{type:String,value:'//youtube.com/playlist?list='},_youtubeVideo:{type:String,value:'//youtube.com/watch?v='},_youtubeChannel:{type:String,value:'//youtube.com/channel/'}},stop:function(){this.player&&this.player.stopVideo()},_openInYoutube:function(a,b){return a+b},_openVideoYoutube:function(a){return'youtube#playlist'===this.videoKind?this._openInYoutube(this._youtubePlaylist,a):this._openInYoutube(this._youtubeVideo,a)},_updateThumb:function(){this.thumbnail&&(this.$.imageThumb.style['background-image']='url(\''+this.thumbnail+'\')',setTimeout(function(){this.$.imageCont.style.opacity='0'}.bind(this),100))},getVideo:function(){return fetch('https://www.googleapis.com/youtube/v3/search?part=snippet&channelId='+this.channelId+'&maxResults=25&key='+this.apiKey)},convertDuration:function(a){var b=/^PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?$/,c=0,d=0,f=0,g='';if(b.test(a)){var h=b.exec(a);h[1]&&(c=+h[1]),h[2]&&(d=+h[2]),h[3]&&(f=+h[3])}return c&&(c=10>c?'0'+c:c,g+=c+':'),d=10>d?'0'+d:d,g+=d+':',f=10>f?'0'+f:f,g+=f,g},loadVideo:function(a,b,c,d){this.player=new this.YT.Player(this.$.video,{height:c,width:b,playerVars:{autoplay:0,controls:1,hd:1,showinfo:0},events:{onReady:function(){'playlist'===a?this.player.cuePlaylist({listType:'playlist',list:this.videoId}):this.player.loadVideoById(this.videoId)}.bind(this),onStateChange:function(f){this.onPlayerStateChange(f,function(g){return d(g)}.bind(this))}.bind(this)}})},onPlayerStateChange:function(b,c){if(b.data===this.YT.PlayerState.CUED){var d=b.target.getVideoUrl();if(c)return c(d)}},getPlayerSize:function(){var a=getComputedStyle(this.$.contentVideo);if(a)return{width:a.width,height:a.height}},playVideo:function(){this.$.imageThumb.style.opacity=0,this.$.playBtn.style.opacity=0,this.$.imageThumb.style['pointer-events']='none',this.$.playBtn.style['pointer-events']='none';var a=this.getPlayerSize();this.loadVideo('video',a.width,a.height,function(){console.log('stopped')})},ready:function(){this.$.yapi.addEventListener('api-load',function(){this.YT=this.$.yapi.api}.bind(this))}});</script></dom-module></body></html>